<!--#exec cgi="/cgi-bin/SmallBackup/r1Counter/r1Counter.pl" --> 

<html>

<link rel="stylesheet" href="style.css" type="text/css">

<title>Small Backup - описание</title>

<table width="80%" align="center">
	<tr>
		<td colspan="2"><div class="SmallBackup">Small Backup</div></td>
	</tr>

	<tr>
		<td valign="top" width="15%">
			<div class="LeftPanel">
				<a href="http://localhost/SmallBackup/index.html">Главная</a><br>
				<a href="http://localhost/SmallBackup/descr.html">Описание</a><br>
				<a href="http://localhost/SmallBackup/download.html">Загрузить</a></br>
				<a href="http://localhost/cgi-bin/SmallBackup/Register/Register.pl">Регистрация</a></br>
				<a href="http://localhost/cgi-bin/SmallBackup/Guestbook/Guestbook.pl">Гостевая книга</a><br>
			</div>
		</td>
		
		<td align="left" valign="top">
			<div class="TextCont">
			<div class="DescrTopicText">
			<p class="First">В этом разделе приводится описание работы с программой
			
			<p>Small Backup - программа для резервного копирования данных. Для того что бы указать что и куда копировать нужно создать <span class="Key">задачу</span>. Основная информация, которую содержит задача - из какой папки брать файлы (<span class="Key">исходная папка</span>) и куда их копировать (<span class="Key">папка назначения</span>). Т.о. для каждой папки которую вы хотите резервно скопировать необходимо создать свою задачу.
			
			<p class="Last">Ниже вы можете узнать подробнее как работать с задачами, назначать им параметры, составлять расписание. Так же вы узнаете как происходит процесс копирования.
			</div>
			
			<h1>Добавление задачи</h1>
			<div class="Text">
			<p class="First">Для добавления задачи вы можете выбрать пункт меню <span class="UI">Задача &gt; Новая</span>, или нажать клавишу <span class="UI">Insert</span>.
			При этом появится окно, на котором будет три вкладки.
			
			<p class="CenterImg"><img src="NewTask.png">
			
			<p>Вкладка <span class="UI">Общие параметры</span>. Сдесь можно указать общие параметры, такие как название задачи,
			исходная папка (откуда копировать файлы), папка назначения (куда копировать), указать обрабатывать ли
			подпапки.
			
			<p>Так же можно задать строку, содержащую макросы работы с текущей датой в поле <span class="UI">Генерировать имя</span>. Эти макросы 
			буду раскрыты при выполнении задачи, т.о. можно генерировать имя папки назначения исходя из текущей даты.
			Подробнее об этом вы можете прочитать ниже.
			
			<p>Остались последние два параметра. <span class="UI">Включать файлы</span> - маска файлов, которые нужно скопировать, <span class="UI">Исключать файлы</span> - маска файлов которые нужно пропустить. По-умолчанию в поле <span class="UI">Включать файлы</span> стоит звезда, а поле <span class="UI">Исключать файлы</span> пустое, что означает обрабатывать все файлы.
			
			<p class="CenterImg"><img src="NewTask-Arch.png">
			
			<p>Вкладка <span class="UI">Архивирование</span>. В качестве архиватора вы можете использовать любой архиватор, но сначала нужно настроить Small Backup. Подробнее о настройке архиваторов вы можете прочитать ниже. По-умолчанию Small Backup настроена на работу с архиватором WinRAR.
			
			<p class="CenterImg"><img src="NewTask-Sch.png">
			
			<p>Вкладка <span class="UI">Расписание</span> служит для задания периодического выполнения задачи. Подробнее о
			работе с расписанием вы можете прочитать ниже.
			
			<p class="Last">После того как вы нажмёте кнопку <span class="UI">ОК</span> задача добавится в список и вы сможете изменить
			её параметры\запустить\удалить.
			</div>
			
			<h1>Генерирование имени папки назначения</h1>
			<div class="Text">
			<p class="First">Для генерирования имени папки назначения можно использовать текущую дату. Что бы
			подставить какое-либо значение, нужно заключить строку в знаки процента '%'.
			Поддерживаются следующие символы (регистр имеет значение):
			
			<p><table align="center" width="80%">
				<tr>
					<th width="25%">Символы</th>
					<th>Значение</th>
				</tr>
				
				<tr>
					<td class="Chars">h</td>
					<td class="CharsDesc">Час без лидирующего нуля; 12-ти часовые сутки</td>
				</tr>
				<tr>
					<td class="Chars">hh</td>
					<td class="CharsDesc">Час с лидирующим нулём; 12-ти часовые сутки</td>
				</tr>	
				<tr>
					<td class="Chars">H</td>
					<td class="CharsDesc">Час без лидирующего нуля; 24-х часовые сутки</td>
				</tr>				
				<tr>
					<td class="Chars">HH</td>
					<td class="CharsDesc">Час с лидирующим нулём; 24-х часовые сутки</td>
				</tr>	
				<tr>
					<td class="Chars">m</td>
					<td class="CharsDesc">Минута без лидирующего нуля</td>
				</tr>	
				<tr>
					<td class="Chars">mm</td>
					<td class="CharsDesc">Минута с лидирующим нулём</td>
				</tr>	
				<tr>
					<td class="Chars">s</td>
					<td class="CharsDesc">Секунда без лидирующего нуля</td>
				</tr>				
				<tr>
					<td class="Chars">ss</td>
					<td class="CharsDesc">Секунда с лидирующим нулём</td>
				</tr>	
				<tr>
					<td class="Chars">t</td>
					<td class="CharsDesc">Односимвольная метка времени, (A или P)</td>
				</tr>
				<tr>
					<td class="Chars">tt</td>
					<td class="CharsDesc">Метка времени (AM или PM)</td>
				</tr>	
				<tr>
					<td class="Chars">d</td>
					<td class="CharsDesc">День месяца без лидирующего нуля</td>
				</tr>				
				<tr>
					<td class="Chars">dd</td>
					<td class="CharsDesc">День месяца с лидирующим нулём</td>
				</tr>	
				<tr>
					<td class="Chars">ddd</td>
					<td class="CharsDesc">День недели, 3 символа</td>
				</tr>
				<tr>
					<td class="Chars">dddd</td>
					<td class="CharsDesc">Целиком название дня недели</td>
				</tr>	
				<tr>
					<td class="Chars">M</td>
					<td class="CharsDesc">Номер месяця без лидирующего нуля</td>
				</tr>
				<tr>
					<td class="Chars">MM</td>
					<td class="CharsDesc">Номер месяця с лидирующим нулём</td>
				</tr>
				<tr>
					<td class="Chars">MMM</td>
					<td class="CharsDesc">Месяц, 3 символа</td>
				</tr>	
				<tr>
					<td class="Chars">MMMM</td>
					<td class="CharsDesc">Полное название месяца</td>
				</tr>	
				<tr>
					<td class="Chars">y</td>
					<td class="CharsDesc">Год, 1-2 символа, без лидирующего нуля</td>
				</tr>	
				<tr>
					<td class="Chars">yy</td>
					<td class="CharsDesc">Год, 2 символа, с лидирующим нулём</td>
				</tr>	
				<tr>
					<td class="Chars">yyyy</td>
					<td class="CharsDesc">Год, 4 символа</td>
				</tr>					
			</table>
			
			<p>Вот несколько примеров (если считать что текущая дата <i>18:06, 08.07.2006</i>):
			<ul>
				<li>%dd.MM.yyyy% = 08.07.2006
				<li>%dd.MM.yyyy (HH-mm)% = 08.07.2006 (18-06)
				<li>%yyyy%\%MMMM%\%dd% (%HH-MM%) = 2006\Июль\08 (18-06).
				В этом случае будет создана папка с именем '2006', затем в этой папке будет создана
				подпапка с именем 'Июль', и в этой папке будет создана папка '08 (18-06)'.
			</ul>
			
			<p class="Last">Строковые значения берутся из настроек Windows, т.е. если у вас русская версия, месяцы будут выводиться на русском (январь, февраль и т.д.), если английская - соответственно на английском (january, february и т.д.).
			</div>
			
			<h1>Настройка архиваторов</h1>
			<div class="Text">
			<p class="First">Т.к. программа использует внешние архиваторы, сначала необходимо настроить командную строку для используемого архиватора. По-умолчанию настройки подходят для WinRAR. Кроме того, в папке с программой находится файл <span class="Key">Archivers.ini</span>, который содержит настройки для разных архиваторов. Вы можете загрузить с сайта последнюю версию этого файла, с новыми архиваторами.
			
			<p>Сначала нужно открыть окно с настройками архиватора. Для этого выберите пункт меню <span class="UI">Настройки &gt; Настройки</span> и выберите вторую вкладку (<span class="UI">Архиваторы</span>).
			
			<p class="CenterImg"><img src="ArchOpt.png">
			
			<p>Для начала нужно указать имя файла архиватора. Это исполняемый файл (.exe).
			
			<p>Далее нужно заполнить поле <span class="UI">Командная строка</span>. В этой строке можно использовать макросы,
			некоторые из которых (в зависимости от настроек задачи) будут заменены значениями, которые
			задаются в списке <span class="UI">Параметры командной строки</span>.
			
			<p>В данном случае командная строка это
			"A %COMPRESS% %SFX% %LOCK% %TASKCMD% -EP1 -ibck %ARCHIVE% %@FILELIST%".
			
			<p>Допустимы следующие макросы:
			<ul>
				<li>%COMPRESS%. Уровень сжатия. При раскрытии, в зависимости от уровня сжатия, установленного в настройках задачи, заменится значением одного из параметров от %compress0% до %compress5%. В данном случае: от '-m0' до '-m5'.
				
				<li>%SFX%. Создание самораспаковывающегося архива. Заменится соответствующим
				параметром из "параметров командной строки" - %sfx% ('-sfx').
				
				<li>%LOCK%. Заблокировать архив ('-k').
				
				<li>%TASKCMD%. Дополнительная командная строка, которая задаётся в свойствах задачи.
			</ul>
			
			<p>Значения следующих макросов задать нельзя, они будут сгенерированы программой во время выполнения задачи.
			
			<ul>				
				<li>%ARCHIVE%. Имя архива который будет создан, совпадает с папкой назначения. Например,
				если папка назначения - "c:\backup", то вместо этого макроса подставится "c:\backup".
				
				<li>%FILELIST%. Имя файла-списка, который содержит имена файлов и папок для архивации.
			</ul>
			
			Например, если в параметрах задачи указан "быстрый" метод архивации и создание 
			самораспаковывающегося архива, а папка назначения c:\backup то эта строка
			раскроется примерно в следующую:
			
			<p>A -m2 -sfx -EP1 -ibck "c:\backup" @"C:\DOCUME~1\Z\LOCALS~1\Temp\smb463.tmp"
			
			<p>При запуске архиватора с данной командной строкой, он выполнит архивацию файлов, как и ожидалось.
			
			<p class="Last">Так же вы можете загрузить параметры других архиваторов. Для этого нужно нажать на кнопку 
			<span class="UI">Загрузить конфигурацию архиватора</span> и выбрать нужный архиватор.
			</div>
			
			<h1>Работа с расписанием</h1>
			<div class="Text">
			<p class="First">В программе можно гибко настроить выполнение задачи по расписанию, но сначала придётся
			немного поучиться.
			
			<p>Расписание представляет из себя т.н. <span class="Key">дерево расписания</span>. Элементы дерева расписания - <span class="Key">временные блоки</span>. Временной блок может быть <span class="Key">неделей</span>, <span class="Key">днём</span> или <span class="Key">часом</span>. Родительский временной блок может иметь несколько дочерних, притом дочерние временные блоки "меньше" родительских, т.е. день может быть дочерним по отношению к неделе, а час по отношению ко дню.
			
			<p>Всегда есть хотя бы один <span class="Key">главный временной блок</span>, все остальные блоки являются дочерними по отношению к главному. Тип главного блока определяет периодичность с которой работает расписание. Например, если тип главного блока <span class="Key">час</span>, то заданное расписание будет повторятся каждый час. Если же тип главного блока <span class="Key">неделя</span> то расписание будет повторятся с периодичностью в неделю.
			
			<p>У временных блоков есть <span class="Key">параметры</span>. Для дня - это <span class="Key">день недели</span> (например, понедельник, вторник), для часа - <span class="Key">час</span> (например, 8, 13, 18). Кроме того можно задать <span class="Key">период временного блока</span> - "с ... по ...". Например, с понедельника по пятницу, с 8 часов до 16.
			
			<p>У временного блока типа <span class="Key">час</span> есть свойства <span class="Key">выполнение задачи</span>. Т.е. что бы задать выполнение задачи нужно обязательно создать хотя бы один временной блок типа <span class="Key">час</span>. Эти свойства - это <span class="Key">время выполнения</span> (в минутах) и <span class="Key">интервал</span> через которые повторять выполнение задачи (тоже в минутах).
			
			<p>Это всё была теория, сейчас покажу несколько примеров.
			
			<ul>
				<li>Выполнять задачу каждые пол-часа. Дерево расписания примет такой вид:
				<p><img src="Sch-1.png">
				<p>Тип главного блока - <span class="Key">час</span>, время выполнения - 0, повторять каждые 30 минут.
				
				<li>Выполнять задачу каждый день с 8 до 16, каждые пол-часа. Дерево расписания
				примет такой вид:
				<p><img src="Sch-2.png">
				<p>Тип главного блока - <span class="Key">день</span>, у дочернего временного блока типа час назначен период - с 8 до 16 часов, и повторять каждые 30 минут.
				
				<li>Выполнять задачу каждый день с полуночи до 7 утра каждый час, с 8 утра до
				16 дня каждые 10 минут, а с 17 до 23 каждые пол-часа:
				<p><img src="Sch-3.png">
				<p>Тип главного блока - <span class="Key">день</span>, есть три дочерних временных блока типа час, соответствующие трём заданным периодам (с 00 до 07, с 08 до 16 и с 17 до 23).
				
				<li>Выполнять задачу с понедельника по пятницу с 8-ми до 16-ти, каждые 10 минут,
				а в выходные - с 14-ти до 18-ти каждые 20 минут:
				<p><img src="Sch-4.png">
				<p>Тип главного блока - <span class="Key">неделя</span>, у главного временного блока есть два дочерних типа день, а у каждого временного блока типа день по одному временному блоку типа час.
			</ul>

			<p>Вы можете создавать сколь угодно сложные схемы, можно задать индивидуальные параметры для каждого дня недели и для каждого часа, а можно задавать параметры для интервалов дней и часов. Легко можно составить простое расписание, например, повторять каждые x минут.
			
			<p class="Last">Для удобства в окошке выводится время следующего запуска задачи при данном 
			дереве расписания.
			
			<h1>Выполнение задачи</h1>
			<div class="Text">
			<p class="First">Когда задача начинает выполняться происходят следующие действия:
			
			<ul>
				<li>раскрываются макросы в имени папки назначения
				<li>создаётся папка назначения. Если её невозможно создать, сообщение об этом
				записывается в лог и выполнение задачи прерывается
				<li>происходит копирование файлов из исходной папки в папку назначения. Если произошла
				ошибка и файл невозможно скопировать - сообщение об этом добавится в лог
				<li>если задана архивация, происходит раскрытие макросов командной строки архиватора
				<li>запускается архиватор и выполняет свою работу. Если архиватор не удалось запустить,
				сообщение об этом добавится в лог. Во время работы архиватора задачу
				невозможно прервать, придётся подождать до завершения процесса архивации
				<li>удаляются временные файлы и выполнение задачи завершается
			</ul>
			
			<p>Выполнение задачи можно прервать в любом месте, кроме момента архивирования.
			
			<p>Время предыдущего запуска запишется даже если задача была прервана на самом раннем этапе (например, невозможно создать папку назначения).
			
			<p>Если выполнение задачи запланировано, например, каждую минуту, а время выполнения задачи больше минуты - сообщение о том что невозможно запустить задачу добавится в файл журнала (<span class="Key">SmallBackup.log</span>).
			
			<p>Во время выполнения задачи вы можете видеть окно с информацией о процессе выполнения. При этом некоторые события записываются в лог, каждое сообщение начинается с <span class="Key">типа сообщения</span> - символа в квадратных скобках.
			
			<p>Типы сообщений в окне выполнения задачи:
			<ul>
				<li>[i] - просто какая-то информация
				<li>[!] - ошибка (например, невозможно скопировать файл). В некоторых случаях
				возможно продолжение выполнения задачи
				<li>[x] - серъёзная ошибка (например, невозможно создать папку назначения). Выполнение
				задачи прерывается
			</ul>
			
			<p>Так же некоторые события записываются в файл журнала (<span class="Key">SmallBackup.log</span>). Сначала в квадратных скобках указывается текущая дата и время, затем тип сообщения, если событие связано с задачей - в квадратных скобках имя задачи. Далее пишется текст сообщения.
			
			<p>Типы сообщений в файле-журнале:
			<ul>
				<li>[i] - информация
				<li>[s] - информация, связанная с расписанием. Например, запуск задачи по расписанию
			</ul>
			
			<p class="Last">Размер файла журнала можно ограничить в настроках программы.
			
			</div>

			</div>
			
			</div>
		</td>
	</tr>

</table>

</html>